<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns="http://www.w3.org/1999/xhtml">

    <ui:composition template="pedidoTemplate.xhtml">
        <ui:define name="metadata" />
        <ui:define name="content">

            <!--<h:body style="font-size:small;padding:0px;">-->

                <h:form id="formManter"  prependId="false" enctype="multipart/form-data" >

                    <h:dataTable 
                        value="#{produtoDAOController.items}" 
                        var="item" border="0" cellpadding="2" 
                        cellspacing="0" rowClasses="jsfcrud_odd_row,jsfcrud_even_row" 
                        rules="all" style="border:solid 1px" width="90%">
                        <f:facet name="header">
                            <h:outputText value="PEDIDO"/>
                        </f:facet>
                        <h:column >
                            <f:facet name="header">
                                <h:outputText value="Produto"/>
                            </f:facet>
                            <img src="WEB-INF/../resources/img/#{item.nomeimagem}" height="130" width="130"/>
                            <!--<p:graphicImage name="WEB-INF/../resources/img/#{item.nomeimagem}" url="WEB-INF/../resources/img/#{item.nomeimagem}"/>-->
                             <h:outputText value="#{item.nome}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Valor"/>
                            </f:facet>
                            <h:outputText value="#{item.valor}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Quantidade"/>
                            </f:facet>
                            <p:selectOneMenu id="qtde#{item.id}">
                                <f:selectItem itemLabel="0" itemValue="0"/>
                                <f:selectItem itemLabel="1" itemValue="1"/>
                                <f:selectItem itemLabel="2" itemValue="2"/>
                                <f:selectItem itemLabel="3" itemValue="3"/>
                                <f:selectItem itemLabel="4" itemValue="4"/>
                                <f:selectItem itemLabel="5" itemValue="5"/>
                                <f:selectItem itemLabel="6" itemValue="6"/>
                                <f:selectItem itemLabel="7" itemValue="7"/>
                                <f:selectItem itemLabel="8" itemValue="8"/>
                                <f:selectItem itemLabel="9" itemValue="9"/>
                                <f:selectItem itemLabel="10" itemValue="10"/>
                            </p:selectOneMenu>
                            <h:outputText value=""/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Opção"/>
                            </f:facet>
                            <p:commandButton value="Adicionar" 
                                actionListener="#{pedidoBean.adicionaCarrinho(item, 2)}"
                                oncomplete="PF('varDialogCarrinho').show();"
                                update=":dialogCarrinho"/>

                        </h:column>
                    </h:dataTable>


                    <p:dataTable var="item">

                        <f:facet name="header">
                            <h:outputText value="Meu Pedido"/>
                        </f:facet>

                        <p:column headerText="Produto" >
                            <h:outputText  />
                        </p:column>

                        <p:column headerText="Quantidade" >
                            <h:outputText  />
                        </p:column>

                        <p:column headerText="Valor Unitário" >
                            <h:outputText />
                        </p:column>


                        <p:column headerText="Opções" >
                            <p:commandButton value="Remover"/>
                        </p:column>

                    </p:dataTable>
                </h:form>

                <p:dialog header="Carrinho" id="dialogCarrinho" 
                          closable="true"     
                        widgetVar="varDialogCarrinho" 
                        hideEffect="bounce" 
                        height="100"
                        width="250"
                        dynamic="true"
                        position="top" 
                        visible="true">
                    <h:form id="formDialog">
                        <h:outputText value="Quantidade:" />
                        <h:outputText value="#{pedidoBean.getCarrinho() != null ? pedidoBean.getCarrinho().size() : 0}" />
                        <br/><br/>
                        <h:outputText value="Total (R$):" />
                        <h:outputText value="#{pedidoBean.getCarrinho() != null ? pedidoBean.getCarrinhoSomaValor() : 0}" />
                        <br/><br/><br/>
                        <p:commandButton value="Limpar" 
                            oncomplete="PF('varDialogCarrinho').show();"
                            update=":dialogCarrinho" 
                            actionListener="#{pedidoBean.removeCarrinho}"/>

                     
                        &nbsp;&nbsp;&nbsp;
                        <p:commandButton value="Finalizar" 
                            oncomplete="PF('varDialogCarrinho').show();"
                            update=":dialogCarrinho" 
                            actionListener="#{pedidoBean.create}"/>

                        
                    </h:form>    
                </p:dialog>

            <!--</h:body>-->
        </ui:define>
</ui:composition>
</html>
